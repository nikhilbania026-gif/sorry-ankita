<!-- Sorry Apology Webpage - single file
     Save this content as index.html and open in a browser.
     This package is ready to upload to Netlify Drop (or any static host).
     Names have been set to Ankita and the letter auto-opens.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>I'm Sorry ‚ù§Ô∏è</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#081228;--card:#071026;--accent:#ff5577;--muted:#9aa4b2}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;padding:24px;
      font-family: 'Montserrat', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255,90,120,0.06), transparent), linear-gradient(180deg,#051223 0%, #071026 100%);
      color:#e6eef8;display:flex;align-items:center;justify-content:center;
    }
    .card{width:100%;max-width:900px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));border-radius:20px;padding:34px;box-shadow:0 14px 60px rgba(2,6,23,0.7);position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.04)}
    .header{display:flex;align-items:center;gap:18px}
    .big-heart{width:120px;height:120px;flex:0 0 120px;display:flex;align-items:center;justify-content:center}
    .big-heart svg{width:110px;height:110px;filter:drop-shadow(0 12px 18px rgba(255,85,119,0.12))}
    .title{font-family:'Playfair Display', serif;font-size:40px;margin:0;line-height:1}
    .sub{color:var(--muted);margin:6px 0 18px}

    .scene{display:flex;gap:20px;align-items:flex-start}
    .left-area{flex:1;min-width:260px}
    .apology{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.02);font-size:17px;line-height:1.6}
    .apology p{margin:8px 0}
    .name-edit{font-weight:700;color:var(--accent);cursor:text}
    .actions{display:flex;gap:12px;margin-top:14px}
    button{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;color:inherit;font-weight:600;cursor:pointer}
    button.primary{background:linear-gradient(90deg,var(--accent),#ff88a5);color:#051226;border:none}
    .small{font-size:13px;color:var(--muted);margin-top:12px}

    /* right visual area */
    .visual{width:360px;flex:0 0 360px;display:flex;flex-direction:column;align-items:center;gap:16px}
    .teddies{display:flex;gap:14px;align-items:flex-end}
    .teddy{width:96px;height:120px;border-radius:12px;background:linear-gradient(180deg,#f7d7c8,#f0bfa6);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 30px rgba(2,6,23,0.5);position:relative}
    .teddy:before{content:'üß∏';font-size:56px;transform:translateY(2px)}

    /* envelope */
    .envelope-wrap{width:260px;height:170px;position:relative}
    .envelope{
      width:100%;height:100%;position:relative;perspective:1000px
    }
    .env-base{position:absolute;left:0;right:0;top:0;bottom:0;background:#fff;border-radius:12px;border:1px solid rgba(0,0,0,0.08);box-shadow:0 10px 30px rgba(2,6,23,0.45);overflow:hidden}
    .env-flap{position:absolute;left:0;right:0;top:0;height:60%;background:linear-gradient(180deg,#ffefef,#ffdfe6);border-bottom:1px solid rgba(0,0,0,0.03);transform-origin:50% 0%;border-top-left-radius:12px;border-top-right-radius:12px}
    .letter{position:absolute;left:12px;right:12px;top:22%;bottom:12px;background:linear-gradient(180deg,#fff,#fff);border-radius:8px;padding:18px;box-shadow:inset 0 0 0 1px rgba(0,0,0,0.02);opacity:0;transform:translateY(8px)}

    /* animations */
    .env-open .env-flap{animation:flapOpen 700ms ease forwards}
    .env-open .letter{animation:slideUp 700ms 300ms ease forwards}
    @keyframes flapOpen{0%{transform:rotateX(0deg)}100%{transform:rotateX(-180deg)}}
    @keyframes slideUp{0%{opacity:0;transform:translateY(12px)}100%{opacity:1;transform:translateY(0)}}

    /* cute sparkle */
    .sparkle{position:absolute;width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,0.9);box-shadow:0 0 10px rgba(255,255,255,0.6);opacity:0;transform:scale(0.6)}
    .sparkle.show{animation:pop 600ms ease forwards}
    @keyframes pop{0%{opacity:0;transform:scale(0.5)}50%{opacity:1;transform:scale(1.05)}100%{opacity:0;transform:scale(1)}}

    /* confetti pieces */
    .confetti-piece{position:absolute;width:10px;height:14px;opacity:0.95;border-radius:2px}

    footer{margin-top:10px;color:var(--muted);font-size:13px}
    @media (max-width:920px){.scene{flex-direction:column}.card{padding:22px}.title{font-size:30px}}
  </style>
</head>
<body>
  <div class="card" id="card">
    <div class="header">
      <div class="big-heart" aria-hidden>
        <!-- Big glossy heart SVG -->
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="heart">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="#ff6b81"/>
              <stop offset="1" stop-color="#ff2d6f"/>
            </linearGradient>
            <filter id="f1" x="-50%" y="-50%" width="200%" height="200%">
              <feDropShadow dx="0" dy="10" stdDeviation="12" flood-color="#ff5577" flood-opacity="0.18"/>
            </filter>
          </defs>
          <g filter="url(#f1)">
            <path fill="url(#g1)" d="M32 54s-22-13.6-22-30A12 12 0 0 1 32 12a12 12 0 0 1 22 12c0 16.4-22 30-22 30z"/>
          </g>
        </svg>
      </div>
      <div>
        <h1 class="title">Ankita, I'm sorry</h1>
        <p class="sub">This little page is my way of saying I messed up ‚Äî and I want to make it right.</p>
      </div>
    </div>

    <div class="scene">
      <div class="left-area">
        <div class="apology" id="apology">
          <p>Dear <span id="name2" contenteditable="true">Ankita</span> ‚Äî</p>
          <p id="msg">Ankita, I'm so sorry. I know I hurt you and I can't take back what happened, but I can promise you this: I will learn from this, be kinder, and show you how much you mean to me every day. Your kindness, your laugh, and the way you make ordinary moments feel special ‚Äî I miss that. Please let me make it right. I understand if you need time, but I'll be here, ready to listen and to do better.</p>
          <p style="margin-top:10px;font-weight:700">‚Äî <span id="from" contenteditable="true">Nikhil</span></p>
        </div>

        <div class="actions">
          <button class="primary" id="copyBtn">Copy message</button>
          <button id="resetBtn">Reset</button>
          <button id="openEnvBtn">Open the letter ‚ù§Ô∏è</button>
        </div>
        <p class="small">Tip: Click the names or signature to personalize. Click "Open the letter" for a cute animation.</p>
      </div>

      <div class="visual" aria-hidden>
        <div class="teddies">
          <div class="teddy" title="Teddy 1"></div>
          <div class="teddy" style="transform:scale(1.05);background:linear-gradient(180deg,#f4e0d4,#f1c8b2)" title="Teddy 2"></div>
        </div>

        <div class="envelope-wrap" id="envelopeWrap" aria-hidden>
          <div class="envelope" id="envelope">
            <div class="env-base"></div>
            <div class="env-flap" id="envFlap"></div>
            <div class="letter" id="letter">
              <div style="font-family:'Playfair Display', serif;font-size:18px;margin-bottom:8px">A small letter</div>
              <div style="font-size:14px;line-height:1.5;color:#243042">Dear <span id="letterName">Ankita</span>,</div>
              <div style="margin-top:8px;font-size:14px;color:#243042">I'm truly sorry. I never wanted to hurt you. You are special to me in so many ways, and I regret the pain I caused. If you'll give me a chance, I will do everything I can to earn your trust back. ‚Äî <strong>Nikhil</strong></div>
            </div>
            <!-- small sparkle positions -->
            <div class="sparkle" id="s1" style="left:12px;top:8px"></div>
            <div class="sparkle" id="s2" style="right:18px;top:18px"></div>
          </div>
        </div>

      </div>
    </div>

    <footer>Want this with soft music, different colors, or translated to another language? I can make it.</footer>
  </div>

  <script>
    // defensive helpers to avoid "cannot read properties of undefined"
    function byId(id){return document.getElementById(id) || null}
    function safeAddListener(el, event, fn){ if(el && typeof el.addEventListener === 'function') el.addEventListener(event, fn) }

    // confetti colors and burst (safe root check)
    const colors = ['#ff6b81','#ffd166','#6bf178','#6bd3ff','#c49bff','#ff8aa6']
    function confettiBurst() {
      const root = byId('card')
      if(!root) return
      for (let i=0;i<20;i++){
        const div = document.createElement('div')
        div.className='confetti-piece'
        div.style.background = colors[Math.floor(Math.random()*colors.length)]
        div.style.left = (10 + Math.random()*80) + '%'
        div.style.top = (10 + Math.random()*60) + '%'
        root.appendChild(div)
        const dx = (Math.random()-0.5)*240
        const dy = 220 + Math.random()*260
        div.animate([
          {transform:'translateY(0) rotate(0deg)', opacity:1},
          {transform:`translate(${dx}px, ${dy}px) rotate(${Math.random()*720}deg)`, opacity:0}
        ],{duration:1200+Math.random()*900,easing:'cubic-bezier(.2,.8,.2,1)'}).onfinish=()=>div.remove()
      }
    }

    // Copy button (safe)
    const copyBtn = byId('copyBtn')
    safeAddListener(copyBtn, 'click', ()=>{
      const apology = byId('apology')
      const text = apology ? apology.innerText.trim() : ''
      if(!text){ alert('Nothing to copy.'); return }
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).then(()=>{ confettiBurst(); alert('Message copied. Paste it anywhere to send.') }, ()=>{ alert('Unable to copy on this browser. You can select the text and copy manually.') })
      } else {
        // fallback
        try{
          const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); confettiBurst(); alert('Message copied. Paste it anywhere to send.');
        }catch(e){ alert('Unable to copy on this browser. You can select the text and copy manually.') }
      }
    })

    // Reset button
    const resetBtn = byId('resetBtn')
    safeAddListener(resetBtn, 'click', ()=>{
      const name2 = byId('name2'); const from = byId('from'); const msg = byId('msg'); const letterName = byId('letterName')
      if(name2) name2.innerText='Ankita'
      if(from) from.innerText='Nikhil'
      if(msg) msg.innerText = "Ankita, I'm so sorry. I know I hurt you and I can't take back what happened, but I can promise you this: I will learn from this, be kinder, and show you how much you mean to me every day. Your kindness, your laugh, and the way you make ordinary moments feel special ‚Äî I miss that. Please let me make it right. I understand if you need time, but I'll be here, ready to listen and to do better."
      if(letterName) letterName.innerText='Ankita'
      confettiBurst()
    })

    // Envelope open - safe guards
    const envelope = byId('envelope')
    const openBtn = byId('openEnvBtn')
    safeAddListener(openBtn, 'click', ()=>{
      if(!envelope){ console.warn('Envelope element not found.'); return }
      envelope.classList.toggle('env-open')
      // sync letter name with edits
      const name2El = byId('name2')
      const letterNameEl = byId('letterName')
      if(letterNameEl && name2El) letterNameEl.innerText = name2El.innerText
      // show sparkles safely
      ['s1','s2'].forEach(id =>{
        const s = byId(id)
        if(!s) return
        s.classList.remove('show')
        // force reflow to restart animation
        void s.offsetWidth
        s.classList.add('show')
      })
      confettiBurst()
    })

    // keep letter name in sync when name2 changes
    const name2 = byId('name2')
    if(name2){ name2.addEventListener('input', ()=>{ const ln = byId('letterName'); if(ln) ln.innerText = name2.innerText }) }

    // make contenteditable fields nicer on mobile (safe)
    ['name2','from'].forEach(id =>{
      const el = byId(id)
      if(!el) return
      el.addEventListener('focus', ()=>{el.style.outline='2px dashed rgba(255,255,255,0.06)'})
      el.addEventListener('blur', ()=>{el.style.outline='none'})
    })

    // pressing Enter while editing signature moves focus away (safe)
    const fromEl = byId('from')
    if(fromEl){ fromEl.addEventListener('keydown', (e)=>{if(e.key==='Enter'){e.preventDefault();e.target.blur();confettiBurst()}}) }

    // Auto-open the letter once when page loads to make sure users see it (but only if envelope exists)
    window.addEventListener('load', ()=>{
      const env = byId('envelope')
      if(env && !env.classList.contains('env-open')){
        // small delay for nicer UX
        setTimeout(()=>{ env.classList.add('env-open'); const ln = byId('letterName'); const n2 = byId('name2'); if(ln && n2) ln.innerText = n2.innerText; ['s1','s2'].forEach(id=>{const s=byId(id); if(!s) return; s.classList.add('show')}); }, 650)
      }
    })

    // Additional safety: log missing critical elements for easier debugging
    ;(function debugMissing(){
      const critical = ['apology','copyBtn','resetBtn','openEnvBtn','envelope','letter','name2','letterName']
      const missing = critical.filter(id => !byId(id))
      if(missing.length) console.info('Warning: some optional elements are missing from the DOM (this is safe):', missing)
    })()
  </script>
</body>
</html>
